<!DOCTYPE html>
<meta charset="utf-8"/>
<html lang="en">
    <head>
        
        <title>Spotter IRL Base</title>

        <link href="/static/bootstrap.min.css" rel="stylesheet">
        <link href="/static/jumbotron-narrow.css" rel="stylesheet">
        <link href="/static/style.css" rel="stylesheet">
        <script src="/static/script.js" charset="utf-8"></script>

        <script type="text/javascript">

            var xhr = new XMLHttpRequest();

            function newRound() {

                var name = prompt("Name of the round");
                var length = prompt("Lenght of round in minutes(integer)");
                var startsAt = prompt("Time of round start(hh:mm)");
                console.log(startsAt.length == 5);
                if (length == parseInt(length, 10) && startsAt.substring(0,2) == parseInt(startsAt.substring(0,2), 10) && startsAt.substring(3,5) == parseInt(startsAt.substring(3,5), 10) && startsAt.length == 5) {
                    var correct = confirm("Do you wish to add round:" + name + ", duration:" + length + ", starting at:" + startsAt);
                    if(correct) {
                        xhr.open("GET", "/addRound?roundName=" + name + "&roundLength=" + length + "&startsAt=" + startsAt, true);
                        xhr.send();
                        //So you won't have to refresh the page manually
                        window.setTimeout(function() {}, 500);
                        window.location.assign(window.location.href);
                    }
                }
            }

            function masterLogout() {
                xhr.open("GET", "/masterout", true);
                xhr.send();
                xhr.onreadystatechange = function() {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        console.log(xhr.responseText)
                        window.location.assign("/masterlogin")
                    }
                }
            }
            
            

        </script>



    </head>
    <body>
        <div class="col-sm-12">
            <div class="col-sm-10 col-sm-offset-1">
                <div id="roundInfo" class="textarea" style="max-height: 65px;"> ---Spawnmaster--- </div>
            </div>

            <div class="col-sm-10 col-sm-offset-1">
                <p><div id="stats" class="textarea base"></div></p>
                    <p>
                        <div id="rounds" class="textarea base">
                            <table style="width:100%;">
                                <tr>
                                    <th>Aktiivne</th>
                                    <th>Id</th>
                                    <th>Nimi</th>
                                    <th>Algusaeg</th>
                                    <th>LÃµpuaeg</th>
                                    <th><input type="submit" value="Uus voor" onclick="newRound()"></th>
                                </tr>
                                {% for round in rounds %}
                                <tr>
                                    <td>{{ round[0] }}</td>
                                    <td>{{ round[1] }}</td>
                                    <td>{{ round[2] }}</td>
                                    <td>{{ round[3] }}</td>
                                    <td>{{ round[4] }}</td>
                                </tr>
                                {% endfor %}
                            </table>
                        </div>
                    </p>
                <div class="col-sm-3 col-sm-offset-8" style="top:20px;">
                </div>
            </div>
        </div>
    </body>
</html>