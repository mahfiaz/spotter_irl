<!DOCTYPE html>
<meta charset="utf-8"/>
<html lang="en">
	<head>
		
		<title>Spotter IRL Base</title>

		<link href="http://getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="http://getbootstrap.com/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">

		<style type="text/css">
			/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */img,legend{border:0}legend,td,th{padding:0}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,optgroup,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre,textarea{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}table{border-collapse:collapse;border-spacing:0}

			body {
				background-image: url("css_dust2.jpg");
				background-size: cover;

			}

			.form-control {
				background-color:#ab4621;
			}

			.textarea {
				color: white;
				font-weight: bold;
				width: 100%;
				background-color: #000000;
				opacity: 0.65;
				border-radius: 5px;
				padding: 5px;
			}

			.bottom {
				position: absolute;
				bottom: 0;
			}
		</style>

		<script type="text/javascript">
			
			var xhr = new XMLHttpRequest();

			function getStats() {
				var stats = "";
				var user = "";

				xhr.open("GET", "/user", true);
				xhr.send();
				xhr.onreadystatechange = function() {
					if (xhr.readyState == 4 && xhr.state == 200) {
						user = xhr.responseText;
					}

				xhr.open("GET", "/stats", true);
				xhr.send();
				xhr.onreadystatechange = function() {
					if (xhr.readyState == 4 && xhr.state == 200) {
						stats = xhr.responseText;
					}
					stats = JSON.parse(stats);
					var statsDiv = document.getElementById("stats")
					statsDiv.innerHTML = "<table><tr><th></th><th>Tabatud</th><th>Puude</th><th>Miinus</th><th>Skoor</th></tr>"
					for(i in stats["teams"]) {
						team = stats["teams"][i];
						statsDiv.innerHTML = statsDiv.innerHTML + "<tr style='color:#"+team["color"]+";'><th>"+team["name"]+"</th><th>"+team["spotCount"]+"</th><th>"+team["touchCount"]+"</th><th>"+team["disloyality"]+"</th><th>"+team["score"]+"</th></tr>";
						for(i in team["players"]) {
							player = team["players"][i];
							if(player["name"] == user) {
								statsDiv.innerHTML = statsDiv.innerHTML + "<tr style='color:#"+team["color"]+";'><td>"+player["name"]+"</td><td>"+player["spotCount"]+"</td><td>"+player["touchCount"]+"</td><td>p"+ayer["disloyality"]+"</td><td>"+player["score"]+"</td></tr></table>";
							}
						}
					}
					for(i in stats["teamlessPlayers"]) {
						player = stats["teamlessPlayers"][i];
						if(player["name"] == user) {
							statsDiv.innerHTML = statsDiv.innerHTML + "<tr><td>"+player["name"]+"</td><td>"+player["spotCount"]+"</td><td>"+player["touchCount"]+"</td><td>p"+ayer["disloyality"]+"</td><td>"+player["score"]+"</td></tr></table>";
						}
					}
				}
			}

			window.onload = function() {
				window.setInsterval(function() {
					getStats();
				}, 4000);
			}

			function tag() {
				console.log("Tagged someone")
			}

			function message() {
				console.log("Messaged team")
			}

		</script>

	</head>
	<body>
		<div class="sm-col-12">
			<div class="col-sm-10 col-sm-offset-1">
				<p>
					<div class="textarea" style="text-align:center; font-size:200%"></div>
				</p>
				<p>
					<div id="stats" class="textarea"></div>
				</p>
				<p>
					<div id="events" class="textarea"></div>
				</p>
				<p style="text-align:center;">
					<input class="form-control" id="fleeingCode" type="text" placeholder="Silmasin koodi">
					<button class="btn-sm btn-danger btn-block" type="button" value="Taba" onclick="tag()">Taba</button>
				</p>
				<p style="text-align:center;width: 100%">
					<input class="form-control" id="fleeingCode" type="text" placeholder="Teade">
					<button class="btn-sm btn-danger btn-block" type="button" value="Saada" onclick="message()">Teade meeskonnale</button>
				</p>
			</div>
		</div>
	</body>
</html>